
# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è WhatsApp APP + –ó–≤–æ–Ω–∫–∏ –≤ vtiger CRM - 7.1.0

Tampermonkey-—Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç –∏–∫–æ–Ω–∫—É WhatsApp —Ä—è–¥–æ–º —Å –Ω–æ–º–µ—Ä–∞–º–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ vtiger CRM - 7.1.0 (–Ω–∞–ø—Ä–∏–º–µ—Ä, `http://crm.local`). –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å —á–∞—Ç –≤ WhatsApp –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ CRM, –∏—Å–ø–æ–ª—å–∑—É—è –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ –≤–µ–±-–≤–µ—Ä—Å–∏—é WhatsApp.

## üì¶ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* üîó –î–æ–±–∞–≤–ª—è–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ WhatsApp —Ä—è–¥–æ–º —Å –∫–∞–∂–¥—ã–º –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞.
* üí¨ –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å —á–∞—Ç –≤ WhatsApp Desktop –∏–ª–∏ Web.
* üìû –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –∏—Å—Ö–æ–¥—è—â–µ–≥–æ –∑–≤–æ–Ω–∫–∞ CRM (`Vtiger_PBXManager_Js.registerPBXOutboundCall`).
* üîç –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—â–µ—Ç –∏ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
* ‚ôªÔ∏è –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ–¥–≥—Ä—É–∂–∞–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ `MutationObserver`.
* ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∫ –º–æ–±–∏–ª—å–Ω—ã—Ö, —Ç–∞–∫ –∏ –≥–æ—Ä–æ–¥—Å–∫–∏—Ö –Ω–æ–º–µ—Ä–æ–≤.
* üßº –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ (–ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ —Ñ–æ—Ä–º–∞—Ç—É WhatsApp).

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [Tampermonkey](https://www.tampermonkey.net/) (–µ—Å–ª–∏ –µ—â—ë –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω).
2. –í–∫–ª—é—á–∏—Ç–µ [—Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ Tampermonkey]([https://www.tampermonkey.net/](https://www.tampermonkey.net/faq.php#Q209)) 
3. –ù–∞–∂–º–∏—Ç–µ ¬´–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç¬ª –≤ –ø–∞–Ω–µ–ª–∏ Tampermonkey.
4. –í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–∫—Ä–∏–ø—Ç–∞ –∏–∑ `whatsapp-crm.user.js`.
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç.
6. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–∞–π—Ç `http://crm.local` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–µ `@match` –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ `@match` –ø–æ–¥ —Å–≤–æ–π –¥–æ–º–µ–Ω CRM.

## üß† –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞**

```js
normalizePhoneNumber()
```

–£–¥–∞–ª—è–µ—Ç –≤—Å–µ –ª–∏—à–Ω–∏–µ —Å–∏–º–≤–æ–ª—ã –∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –Ω–æ–º–µ—Ä –∫ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É: `+7XXXXXXXXXX`.

### 2. **–°–æ–∑–¥–∞–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ WhatsApp**

```js
createWhatsAppIcon()
```

–§–æ—Ä–º–∏—Ä—É–µ—Ç —Å—Å—ã–ª–∫—É:

* `whatsapp://send?phone=...` ‚Äî –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
* `https://web.whatsapp.com/send?phone=...` ‚Äî (—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫—É –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
* `https://api.whatsapp.com/send?phone=...` ‚Äî (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≤–µ–±-–≤–µ—Ä—Å–∏—è)

### 3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –Ω–æ–º–µ—Ä–æ–≤**

```js
processExistingPhoneNumbers()
```

–ù–∞—Ö–æ–¥–∏—Ç —ç–ª–µ–º–µ–Ω—Ç—ã `<a class="phoneField">` –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∫ –Ω–∏–º –∏–∫–æ–Ω–∫—É WhatsApp, –µ—Å–ª–∏ –æ–Ω–∞ –µ—â—ë –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞.

### 4. **–ü–æ–∏—Å–∫ –≤ —Ç–µ–∫—Å—Ç–µ**

```js
findPhoneNumbersInText()
```

–û–±—Ö–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —É–∑–ª—ã DOM –∏ –∏—â–µ—Ç –Ω–æ–º–µ—Ä–∞, –∑–∞–º–µ–Ω—è—è –∏—Ö –Ω–∞ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ —Å –∏–∫–æ–Ω–∫–æ–π WhatsApp.

### 5. **–ù–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ DOM**

```js
MutationObserver
```

–ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫—Ä–∏–ø—Ç—É –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–ª—è—é—â–∏–µ—Å—è –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ AJAX-–∑–∞–≥—Ä—É–∑–∫–∏).

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–í –∫–æ–¥–µ –µ—Å—Ç—å –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏:

* –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è **–≤–µ–±-–≤–µ—Ä—Å–∏–∏ WhatsApp** –≤–º–µ—Å—Ç–æ –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏ `window.open(...)` –∏ —Å—Å—ã–ª–∫—É `https://web.whatsapp.com/send?...`.

## üì∑ –ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

–¢–µ–ª–µ—Ñ–æ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–∞–∫:

```
+7 (999) 123-45-67 üìû üü¢ (–∏–∫–æ–Ω–∫–∞ WhatsApp)
```

–ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –∏–∫–æ–Ω–∫—É –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —á–∞—Ç –≤ WhatsApp —Å —ç—Ç–∏–º –Ω–æ–º–µ—Ä–æ–º.

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–°–∫—Ä–∏–ø—Ç –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –≤–∞—à–µ–≥–æ CRM –∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–Ω–µ—à–Ω–∏–µ API (–∫—Ä–æ–º–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∏–∫–æ–Ω–∫—É WhatsApp).


## üìå –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

* vtiger CRM - 7.1.0, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∞—è –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –≤ DOM
* Tampermonkey –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
* WhatsApp Desktop –∏–ª–∏ Web

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License ‚Äî —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ –ø–æ–¥ —Å–µ–±—è.
